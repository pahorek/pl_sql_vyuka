CREATE TABLE CESTA (
    CESTA_ID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    CESTA VARCHAR2(1000) UNIQUE
);
CREATE TABLE JMENO_SOUBORU (
    ID_JMENO_SOUBORU NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    JMENO_SOUBORU VARCHAR2(500) UNIQUE,
    CESTA_ID NUMBER NOT NULL,
    CONSTRAINT FK_SOUBOR_CESTA FOREIGN KEY (CESTA_ID)
        REFERENCES CESTA(CESTA_ID)
);

CREATE TABLE ListExcel (
    ID_ListExcel NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NAZEV_LISTU VARCHAR2(255) NOT NULL,
    ID_JMENO_SOUBORU NUMBER NOT NULL,
    CONSTRAINT FK_ListExcel_Soubor FOREIGN KEY (ID_JMENO_SOUBORU)
        REFERENCES JMENO_SOUBORU(ID_JMENO_SOUBORU),
    CONSTRAINT UQ_ListExcel UNIQUE (ID_JMENO_SOUBORU, NAZEV_LISTU)
);
CREATE TABLE JMENO_TABULKY (
    ID_JMENO_TABULKY NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NAZEV_TABULKY VARCHAR2(255) NOT NULL,
    ID_ListExcel NUMBER NOT NULL,

    CONSTRAINT FK_JT_ListExcel FOREIGN KEY (ID_ListExcel)
        REFERENCES ListExcel(ID_ListExcel),

    CONSTRAINT UQ_JT UNIQUE (ID_ListExcel, NAZEV_TABULKY)
);

CREATE TABLE BUNKA (
    ID_BUNKA NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    RADek NUMBER NOT NULL,
    SLOUPEC NUMBER NOT NULL,
    ID_ListExcel NUMBER NOT NULL,
    ID_JMENO_TABULKY NUMBER NULL,

    CONSTRAINT FK_BUNKA_LIST FOREIGN KEY (ID_ListExcel)
        REFERENCES ListExcel(ID_ListExcel),

    CONSTRAINT FK_BUNKA_TAB FOREIGN KEY (ID_JMENO_TABULKY)
        REFERENCES JMENO_TABULKY(ID_JMENO_TABULKY),

    CONSTRAINT UQ_BUNKA UNIQUE (ID_ListExcel, RADek, SLOUPEC)
);

CREATE TABLE HODNOTY_ALT (
    ID_HODNOTY NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    ID_BUNKA NUMBER NOT NULL,
    ID_JMENO_TABULKY NUMBER NULL,

    ROK_PUBL INTEGER,
    Q_PUBL INTEGER,
    HODN_ROK INTEGER,
    HODN_Q INTEGER,
    VERZE VARCHAR2(4),
    ULOHA VARCHAR2(100),

    HODNOTA NUMBER,
    ROK NUMBER(4),
    KVARTAL NUMBER(1),
    DATUM_IMPORTU DATE DEFAULT SYSDATE,

    CONSTRAINT FK_HODNOTY_BUNKA FOREIGN KEY (ID_BUNKA)
        REFERENCES BUNKA(ID_BUNKA),

    CONSTRAINT FK_HODNOTY_TAB FOREIGN KEY (ID_JMENO_TABULKY)
        REFERENCES JMENO_TABULKY(ID_JMENO_TABULKY)
);
